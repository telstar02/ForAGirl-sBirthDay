/* style.css (完整版 - 新增音乐控件样式) */

/* --- 1. 全局和字体设置 --- */
* { box-sizing: border-box; }
html, body { background-color: #000; color: #FFF; margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif; font-weight: 400; }

/* --- 2. 3D 世界和透视 --- */
body { perspective: 1000px; }
#world { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 1.5s cubic-bezier(0.77, 0, 0.175, 1); }

/* --- 3. .page Common Styles --- */
.page { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; backface-visibility: hidden; transform-style: preserve-3d; }

/* --- 4. Inner Content & Typography --- */
.content-wrapper { max-width: 800px; width: 90%; }
h1 { font-size: 3.0em; font-weight: 700; letter-spacing: 2px; }
h2 { font-weight: 600; font-size: 2.5em; }
p { font-size: 1.2em; line-height: 1.6; color: #f0f0f0; }

/* --- 5. Element 3D Parallax --- */
#cover-page #countdown { transition: opacity 0.5s ease, filter 0.5s ease; z-index: 10; position: relative; }
#cover-page #enter-button { opacity: 0; pointer-events: none; z-index: 10; position: relative; transition: opacity 0.5s ease 0.5s, background-color 0.3s ease, color 0.3s ease; }
#cover-page .waiting-text { transition: opacity 0.5s ease; z-index: 10; position: relative; }
#birthday-page h1 { transform: translateZ(50px); }
#birthday-page p { transform: translateZ(-20px); }
.nav-controls { transform: translateZ(40px); }

/* --- 6. Countdown Specific Styles --- */
#countdown p { font-size: 1.5em; color: #aaa; }
#timer-display { font-size: 3.5em; margin: 20px 0; font-weight: 600; letter-spacing: 3px; }
.waiting-text { font-size: 0.9em; color: #555; }

/* --- 7. Button Styles (Unified) --- */
#enter-button { font-size: 1.5em; background-color: #FFF; color: #000; border: 2px solid #FFF; padding: 15px 40px; cursor: pointer; letter-spacing: 2px; margin-top: 20px; font-weight: 600; }
#enter-button:hover { background-color: #000; color: #FFF; }
.nav-button { font-size: 1.2em; background-color: #FFF; color: #000; border: 2px solid #FFF; padding: 10px 30px; cursor: pointer; transition: all 0.3s ease; letter-spacing: 1px; margin-top: 20px; font-weight: 600; }
.nav-button:hover { background-color: #000; color: #FFF; }
.nav-controls { display: flex; justify-content: center; gap: 20px; margin-top: 30px; }

/* --- 8. Canvas Content Styles --- */
.quiz-options { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; width: 90%; max-width: 500px; }
.answer { font-size: 1.1em; background-color: #333; color: #FFF; border: 2px solid #555; padding: 15px 20px; cursor: pointer; transition: all 0.3s ease; font-family: inherit; font-weight: 400; }
.answer:hover { background-color: #555; border-color: #FFF; }

#ascii-art-typing { font-family: 'Courier New', Courier, monospace; font-size: 16px; line-height: 1.1; color: #FFF; text-align: left; white-space: pre; overflow: hidden; border-right: .15em solid white; margin: 20px auto; width: fit-content; animation: blink-caret .75s step-end infinite; min-height: 1em; }
@keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: white; } }
#ascii-art-typing .kitty { color: hotpink; }

/* --- 9. Canvas Effect: 3D Flip Calendar --- */
.flip-card-stage { width: 250px; height: 300px; margin: 30px auto; perspective: 1200px; transform: translateZ(60px); }
.flip-card-actor { width: 100%; height: 100%; position: relative; cursor: pointer; transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.7, 0, 0.3, 1); }
.flip-card-actor.is-flipped { transform: rotateX(180deg); }
.flip-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #000; border: 3px solid #FFF; border-radius: 10px; }
.card-front { }
.calendar-top { font-size: 1.5em; font-weight: 600; background-color: #FFF; color: #000; padding: 5px 20px; width: 100%; text-align: center; border-radius: 6px 6px 0 0; }
.calendar-day { font-size: 8em; font-weight: 700; margin: 10px 0; }
.click-hint { font-size: 0.9em; color: #888; }
.card-back { transform: rotateX(180deg); font-size: 0.9em; padding: 20px; }
.card-back p { font-weight: 300; }

/* --- 10. Smooth Fade Out Effect --- */
.is-hidden { opacity: 0 !important; filter: blur(5px); pointer-events: none; }

/* --- 11. Vortex Portal Effect --- */
.is-opening-portal { mask-image: radial-gradient( circle at center, transparent 0%, transparent 0%, black 0.1%, black 100% ); animation: portal-open 1.5s cubic-bezier(0.6, 0.04, 0.98, 0.335) 1 forwards; }
@keyframes portal-open { from { mask-image: radial-gradient( circle at center, transparent 0%, transparent 0%, black 0.1%, black 100% ); opacity: 1; } to { mask-image: radial-gradient( circle at center, transparent 150%, transparent 150%, black 150.1%, black 100% ); opacity: 0.5; } }

/* --- 12. Particle Torch --- */
#final-page { cursor: none; }
#final-page .nav-button { cursor: pointer; }
#final-page #ascii-wick { cursor: none; }

#torch { position: fixed; top: 0; left: 0; width: 25px; height: 25px; background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,165,0,0.7) 30%, rgba(255,100,0,0.4) 70%, transparent 100%); border-radius: 50%; box-shadow: 0 0 15px 5px rgba(255,165,0,0.5); transform: translate(-50%, -50%); pointer-events: none; z-index: 9999; opacity: 0; transition: opacity 0.3s ease; }
body.final-page-active #torch { opacity: 1; }

#particle-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9998; }
.particle-base { position: fixed; background-color: #FFA500; border-radius: 50%; opacity: 0; pointer-events: none; }
.particle { width: 6px; height: 6px; animation-name: particle-spark; animation-duration: 1s; animation-timing-function: ease-out; animation-fill-mode: forwards; animation-iteration-count: 1; }
@keyframes particle-spark { 0% { opacity: 1; transform: scale(1) translateY(0); } 100% { opacity: 0; transform: scale(0) translateY(-80px) translateX(var(--random-x)); } }

/* --- 13. ASCII Cake Effect --- */
#ascii-cake { font-family: 'Courier New', Courier, monospace; font-size: 19px; line-height: 1.0; color: #FFF; text-align: center; white-space: pre; display: block; margin: 20px auto 0px auto; width: fit-content; transform: perspective(600px) rotateX(20deg) translateZ(30px); }
#ascii-cake span { position: relative; display: inline-block; }
#ascii-flame { color: #FFA500; font-weight: bold; transform: translateY(-8px); height: 0; line-height: 0; z-index: 3; width: 1ch; }
#ascii-cake .candle { color: #F0F0F0; }
#ascii-cake .candle-wick { color: #C0C0C0; padding: 0 1px; margin: 0 -1px; z-index: 2; }
#ascii-cake .icing-middle { color: #FFDEAD; }
#ascii-cake .cake-fill { color: #D2B48C; }
#wish-message { margin-top: 20px; }
#wish-message.is-lit { opacity: 1 !important; transition: opacity 1s ease 0.5s; }

/* --- 14. Firework Effects --- */
.particle-rocket { width: 7px; height: 7px; background-color: white; border-radius: 50%; box-shadow: 0 0 10px 3px rgba(255, 255, 255, 0.8); opacity: 0; pointer-events: none; animation-name: rocket-fade-out; animation-duration: 0.3s; animation-timing-function: linear; animation-fill-mode: forwards; animation-iteration-count: 1; animation-play-state: paused; }
@keyframes rocket-fade-out { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.5); } }
.particle-spark-colored { width: 6px; height: 6px; border-radius: 50%; animation-name: spark-explode-fall; animation-duration: 1.5s; animation-timing-function: ease-out; animation-fill-mode: forwards; animation-iteration-count: 1; }
@keyframes spark-explode-fall { 0% { opacity: 1; transform: scale(1) translate(0, 0); } 100% { opacity: 0; transform: scale(0) translate(var(--random-x-explosion), var(--random-y-explosion)); } }

/* --- 15. Polaroid Pile --- */
#gallery-1 .content-wrapper { display: flex; flex-direction: column; height: 100%; width: 90%; max-width: 95%; }
#gallery-1 h2, #gallery-1 .nav-controls { flex-shrink: 0; }
.polaroid-pile-container { position: relative; width: 100%; flex-grow: 1; min-height: 250px; }
.polaroid-card { background: #fff; border: 1px solid #ddd; padding: 10px; padding-bottom: 20px; box-shadow: 3px 3px 10px rgba(0,0,0,0.5); filter: grayscale(100%); position: absolute; left: 50%; top: 50%; width: 200px; transform: translate(-50%, -50%) rotate(var(--r, 0deg)) translate(var(--x, 0), var(--y, 0)); transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), filter 0.4s ease, box-shadow 0.4s ease; cursor: pointer; }
.polaroid-card img { width: 100%; height: auto; display: block; }
.polaroid-card:hover { filter: grayscale(0%); box-shadow: 10px 10px 20px rgba(0,0,0,0.3); z-index: 10; transform: translate(-50%, -50%) scale(1.15) rotate(0deg); }

/* --- 16. (NEW) Music Control --- */
#music-control {
    position: fixed; /* 固定在屏幕上 */
    bottom: 20px;
    right: 20px;
    z-index: 10000; /* 保持在最顶层 */
    
    background: rgba(255, 255, 255, 0.1); /* 半透明背景 */
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%; /* 圆形 */
    width: 45px;
    height: 45px;
    
    display: none; /* (新) 默认隐藏 */
    justify-content: center;
    align-items: center;
    
    font-size: 20px; /* emoji 大小 */
    cursor: pointer;
    transition: all 0.3s ease;
    
    /* (新) 增加一个微妙的 "呼吸" 发光效果 */
    animation: music-glow 2.5s infinite alternate;
}
#music-control:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
}

/* (新) 音乐播放时发光 */
@keyframes music-glow {
    from { box-shadow: 0 0 5px rgba(255,255,255,0.2); }
    to { box-shadow: 0 0 15px 5px rgba(255,255,255,0.4); }
}

/* (新) 音乐暂停时的样式 */
#music-control.is-muted {
    animation: none; /* 暂停时停止发光 */
    background: rgba(0, 0, 0, 0.3);
    opacity: 0.5;
}